/**
 * Border Line Data - à¹€à¸ªà¹‰à¸™à¸Šà¸²à¸¢à¹à¸”à¸™à¹„à¸—à¸¢-à¸à¸±à¸¡à¸žà¸¹à¸Šà¸² (à¸ˆ.à¸•à¸£à¸²à¸”)
 * 
 * à¹ƒà¸Šà¹‰à¸«à¸¥à¸²à¸¢à¸ˆà¸¸à¸”à¸­à¹‰à¸²à¸‡à¸­à¸´à¸‡à¸•à¸²à¸¡à¹à¸™à¸§à¸Šà¸²à¸¢à¹à¸”à¸™à¹€à¸žà¸·à¹ˆà¸­à¸„à¸³à¸™à¸§à¸“à¸£à¸°à¸¢à¸°à¸—à¸µà¹ˆà¹à¸¡à¹ˆà¸™à¸¢à¸³à¸‚à¸¶à¹‰à¸™
 * à¹à¸—à¸™à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸ˆà¸¸à¸”à¹€à¸”à¸µà¸¢à¸§ (à¸”à¹ˆà¸²à¸™à¸«à¸²à¸”à¹€à¸¥à¹‡à¸)
 * 
 * à¸«à¸¡à¸²à¸¢à¹€à¸«à¸•à¸¸: à¸£à¸°à¸¢à¸°à¸—à¸µà¹ˆà¸„à¸³à¸™à¸§à¸“à¸¢à¸±à¸‡à¸„à¸‡à¹€à¸›à¹‡à¸™ "à¹‚à¸”à¸¢à¸›à¸£à¸°à¸¡à¸²à¸“" à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™
 */

/**
 * à¸ˆà¸¸à¸”à¸šà¸™à¹€à¸ªà¹‰à¸™à¸Šà¸²à¸¢à¹à¸”à¸™à¹„à¸—à¸¢-à¸à¸±à¸¡à¸žà¸¹à¸Šà¸² (à¹€à¸‰à¸žà¸²à¸° à¸ˆ.à¸•à¸£à¸²à¸”)
 * à¹€à¸£à¸µà¸¢à¸‡à¸ˆà¸²à¸à¹ƒà¸•à¹‰à¹„à¸›à¹€à¸«à¸™à¸·à¸­ à¸•à¸²à¸¡à¹à¸™à¸§à¸Šà¸²à¸¢à¹à¸”à¸™
 */
export const TRAT_BORDER_POINTS = [
  // à¸Šà¸²à¸¢à¹à¸”à¸™à¸—à¸°à¹€à¸¥ (à¹ƒà¸•à¹‰à¸ªà¸¸à¸”)
  { lat: 11.55, lng: 102.90 },
  
  // à¸”à¹ˆà¸²à¸™à¸«à¸²à¸”à¹€à¸¥à¹‡à¸
  { lat: 11.6778, lng: 102.9055 },
  
  // à¸Šà¸²à¸¢à¹à¸”à¸™ à¸­.à¸„à¸¥à¸­à¸‡à¹ƒà¸«à¸à¹ˆ
  { lat: 11.75, lng: 102.90 },
  { lat: 11.85, lng: 102.88 },
  { lat: 11.95, lng: 102.85 },
  
  // à¸Šà¸²à¸¢à¹à¸”à¸™ à¸­.à¸šà¹ˆà¸­à¹„à¸£à¹ˆ
  { lat: 12.10, lng: 102.82 },
  { lat: 12.25, lng: 102.80 },
  { lat: 12.35, lng: 102.78 },
  { lat: 12.45, lng: 102.75 },
  
  // à¸Šà¸²à¸¢à¹à¸”à¸™à¹€à¸«à¸™à¸·à¸­à¸ªà¸¸à¸”à¸‚à¸­à¸‡à¸•à¸£à¸²à¸” (à¸•à¸´à¸” à¸ˆ.à¸ˆà¸±à¸™à¸—à¸šà¸¸à¸£à¸µ)
  { lat: 12.55, lng: 102.70 },
]

/**
 * à¸„à¸³à¸™à¸§à¸“à¸£à¸°à¸¢à¸°à¸«à¹ˆà¸²à¸‡à¸£à¸°à¸«à¸§à¹ˆà¸²à¸‡à¸ªà¸­à¸‡à¸ˆà¸¸à¸” (Haversine Formula)
 * @param {number} lat1 - à¸¥à¸°à¸•à¸´à¸ˆà¸¹à¸”à¸ˆà¸¸à¸”à¸—à¸µà¹ˆ 1
 * @param {number} lng1 - à¸¥à¸­à¸‡à¸ˆà¸´à¸ˆà¸¹à¸”à¸ˆà¸¸à¸”à¸—à¸µà¹ˆ 1
 * @param {number} lat2 - à¸¥à¸°à¸•à¸´à¸ˆà¸¹à¸”à¸ˆà¸¸à¸”à¸—à¸µà¹ˆ 2
 * @param {number} lng2 - à¸¥à¸­à¸‡à¸ˆà¸´à¸ˆà¸¹à¸”à¸ˆà¸¸à¸”à¸—à¸µà¹ˆ 2
 * @returns {number} à¸£à¸°à¸¢à¸°à¸«à¹ˆà¸²à¸‡à¹€à¸›à¹‡à¸™à¸à¸´à¹‚à¸¥à¹€à¸¡à¸•à¸£
 */
export const haversineDistance = (lat1, lng1, lat2, lng2) => {
  const R = 6371 // à¸£à¸±à¸¨à¸¡à¸µà¹‚à¸¥à¸ (à¸à¸¡.)
  const dLat = ((lat2 - lat1) * Math.PI) / 180
  const dLng = ((lng2 - lng1) * Math.PI) / 180
  const a = 
    Math.sin(dLat / 2) ** 2 +
    Math.cos((lat1 * Math.PI) / 180) * 
    Math.cos((lat2 * Math.PI) / 180) * 
    Math.sin(dLng / 2) ** 2
  return R * 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a))
}

/**
 * à¸«à¸²à¸£à¸°à¸¢à¸°à¸—à¸µà¹ˆà¸ªà¸±à¹‰à¸™à¸—à¸µà¹ˆà¸ªà¸¸à¸”à¸ˆà¸²à¸à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰à¹„à¸›à¸¢à¸±à¸‡à¹€à¸ªà¹‰à¸™à¸Šà¸²à¸¢à¹à¸”à¸™
 * à¸§à¸´à¸˜à¸µ: à¸§à¸™à¸«à¸²à¸ˆà¸¸à¸”à¸—à¸µà¹ˆà¹ƒà¸à¸¥à¹‰à¸—à¸µà¹ˆà¸ªà¸¸à¸”à¸ˆà¸²à¸à¸«à¸¥à¸²à¸¢à¸ˆà¸¸à¸”à¸šà¸™à¹€à¸ªà¹‰à¸™à¸Šà¸²à¸¢à¹à¸”à¸™
 * 
 * @param {number} lat - à¸¥à¸°à¸•à¸´à¸ˆà¸¹à¸”à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰
 * @param {number} lng - à¸¥à¸­à¸‡à¸ˆà¸´à¸ˆà¸¹à¸”à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰
 * @returns {number} à¸£à¸°à¸¢à¸°à¸«à¹ˆà¸²à¸‡à¸—à¸µà¹ˆà¸ªà¸±à¹‰à¸™à¸—à¸µà¹ˆà¸ªà¸¸à¸”à¹€à¸›à¹‡à¸™à¸à¸´à¹‚à¸¥à¹€à¸¡à¸•à¸£ (à¸›à¸±à¸”à¸—à¸¨à¸™à¸´à¸¢à¸¡)
 */
export const getDistanceToBorder = (lat, lng) => {
  let minDistance = Infinity

  TRAT_BORDER_POINTS.forEach(point => {
    const dist = haversineDistance(lat, lng, point.lat, point.lng)
    if (dist < minDistance) {
      minDistance = dist
    }
  })

  return Math.round(minDistance)
}

/**
 * à¸›à¸£à¸°à¹€à¸¡à¸´à¸™à¸£à¸°à¸”à¸±à¸šà¸„à¸§à¸²à¸¡à¹ƒà¸à¸¥à¹‰à¸Šà¸²à¸¢à¹à¸”à¸™ (à¹„à¸¡à¹ˆà¹ƒà¸Šà¹‰à¸„à¸³à¸§à¹ˆà¸² "à¸›à¸¥à¸­à¸”à¸ à¸±à¸¢/à¸­à¸±à¸™à¸•à¸£à¸²à¸¢")
 * 
 * @param {number} distanceKm - à¸£à¸°à¸¢à¸°à¸«à¹ˆà¸²à¸‡à¹€à¸›à¹‡à¸™à¸à¸´à¹‚à¸¥à¹€à¸¡à¸•à¸£
 * @returns {Object} à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸£à¸°à¸”à¸±à¸šà¸„à¸§à¸²à¸¡à¹ƒà¸à¸¥à¹‰
 */
export const getDistanceLevel = (distanceKm) => {
  if (distanceKm <= 10) {
    return { 
      level: 'VERY_CLOSE', 
      color: '#dc2626', 
      emoji: 'ðŸ”´',
      text: 'à¹ƒà¸à¸¥à¹‰à¸Šà¸²à¸¢à¹à¸”à¸™à¸¡à¸²à¸',
      description: 'à¸­à¸¢à¸¹à¹ˆà¹ƒà¸™à¸£à¸°à¸¢à¸° 10 à¸à¸¡. à¸ˆà¸²à¸à¸Šà¸²à¸¢à¹à¸”à¸™'
    }
  }
  if (distanceKm <= 20) {
    return { 
      level: 'CLOSE', 
      color: '#ea580c', 
      emoji: 'ðŸŸ ',
      text: 'à¹ƒà¸à¸¥à¹‰à¸Šà¸²à¸¢à¹à¸”à¸™',
      description: 'à¸­à¸¢à¸¹à¹ˆà¹ƒà¸™à¸£à¸°à¸¢à¸° 10-20 à¸à¸¡. à¸ˆà¸²à¸à¸Šà¸²à¸¢à¹à¸”à¸™'
    }
  }
  if (distanceKm <= 50) {
    return { 
      level: 'MODERATE', 
      color: '#f59e0b', 
      emoji: 'ðŸŸ¡',
      text: 'à¸£à¸°à¸¢à¸°à¸›à¸²à¸™à¸à¸¥à¸²à¸‡',
      description: 'à¸­à¸¢à¸¹à¹ˆà¹ƒà¸™à¸£à¸°à¸¢à¸° 20-50 à¸à¸¡. à¸ˆà¸²à¸à¸Šà¸²à¸¢à¹à¸”à¸™'
    }
  }
  if (distanceKm <= 90) {
    return { 
      level: 'FAR', 
      color: '#84cc16', 
      emoji: 'ðŸŸ¢',
      text: 'à¸„à¹ˆà¸­à¸™à¸‚à¹‰à¸²à¸‡à¹„à¸à¸¥',
      description: 'à¸­à¸¢à¸¹à¹ˆà¹ƒà¸™à¸£à¸°à¸¢à¸° 50-90 à¸à¸¡. à¸ˆà¸²à¸à¸Šà¸²à¸¢à¹à¸”à¸™'
    }
  }
  return { 
    level: 'VERY_FAR', 
    color: '#22c55e', 
    emoji: 'âœ…',
    text: 'à¹„à¸à¸¥à¸ˆà¸²à¸à¸Šà¸²à¸¢à¹à¸”à¸™',
    description: 'à¸­à¸¢à¸¹à¹ˆà¸«à¹ˆà¸²à¸‡à¸ˆà¸²à¸à¸Šà¸²à¸¢à¹à¸”à¸™à¸¡à¸²à¸à¸à¸§à¹ˆà¸² 90 à¸à¸¡.'
  }
}

export default {
  TRAT_BORDER_POINTS,
  haversineDistance,
  getDistanceToBorder,
  getDistanceLevel
}
